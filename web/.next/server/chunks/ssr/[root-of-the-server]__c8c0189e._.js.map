{"version":3,"sources":["../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/app-router-context.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-server-dom-turbopack-client.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","../../../../app/chat/page.tsx","../../../../node_modules/%40heroicons/react/24/outline/esm/PaperAirplaneIcon.js"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].AppRouterContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactServerDOMTurbopackClient\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","'use client';\n\nimport { useState, useRef, useEffect } from 'react';\nimport Layout from '@/components/Layout';\nimport { chatApi } from '@/lib/api';\nimport toast from 'react-hot-toast';\nimport { PaperAirplaneIcon } from '@heroicons/react/24/outline';\n\ninterface Message {\n  role: 'user' | 'assistant';\n  content: string;\n  sql_query?: string;\n  sources?: any[];\n}\n\nexport default function ChatPage() {\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [input, setInput] = useState('');\n  const [loading, setLoading] = useState(false);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!input.trim() || loading) return;\n\n    const userMessage: Message = { role: 'user', content: input };\n    setMessages((prev) => [...prev, userMessage]);\n    setInput('');\n    setLoading(true);\n\n    try {\n      const response = await chatApi.query(input);\n      const assistantMessage: Message = {\n        role: 'assistant',\n        content: response.answer,\n        sql_query: response.sql_query,\n        sources: response.sources,\n      };\n      setMessages((prev) => [...prev, assistantMessage]);\n    } catch (error: any) {\n      toast.error(error.response?.data?.detail || 'Failed to get response');\n      console.error(error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <Layout>\n      <div className=\"flex flex-col h-[calc(100vh-8rem)]\">\n        <h1 className=\"text-3xl font-bold text-gray-900 mb-6\">Chat with Insight Agent</h1>\n\n        {/* Messages */}\n        <div className=\"flex-1 overflow-y-auto space-y-4 mb-4 pr-2\">\n          {messages.length === 0 ? (\n            <div className=\"text-center text-gray-500 mt-12\">\n              <div className=\"bg-white rounded-xl shadow-md p-8 max-w-md mx-auto\">\n                <p className=\"text-lg font-semibold text-gray-900 mb-2\">Ask me anything about your documents!</p>\n                <p className=\"text-sm text-gray-600\">Try: \"What are my top vendors?\" or \"Show me spending trends\"</p>\n              </div>\n            </div>\n          ) : (\n            messages.map((message, index) => (\n              <div\n                key={index}\n                className={`flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}\n              >\n                <div\n                  className={`max-w-3xl rounded-xl px-5 py-3 shadow-md ${\n                    message.role === 'user'\n                      ? 'bg-gradient-to-r from-blue-600 to-blue-700 text-white'\n                      : 'bg-white text-gray-900 border border-gray-200'\n                  }`}\n                >\n                  <div className=\"whitespace-pre-wrap\">{message.content}</div>\n                  {message.sql_query && (\n                    <details className=\"mt-2\">\n                      <summary className=\"cursor-pointer text-sm opacity-75\">Show SQL Query</summary>\n                      <pre className=\"mt-2 text-xs bg-gray-100 p-2 rounded overflow-x-auto\">\n                        {message.sql_query}\n                      </pre>\n                    </details>\n                  )}\n                  {message.sources && message.sources.length > 0 && (\n                    <details className=\"mt-2\">\n                      <summary className=\"cursor-pointer text-sm opacity-75\">\n                        Show Sources ({message.sources.length})\n                      </summary>\n                      <div className=\"mt-2 space-y-2\">\n                        {message.sources.map((source, i) => (\n                          <div key={i} className=\"text-xs bg-gray-100 p-2 rounded\">\n                            {typeof source === 'object' ? (\n                              <>\n                                <div className=\"font-medium\">{source.filename}</div>\n                                <div className=\"text-gray-600\">{source.text_snippet?.substring(0, 200)}...</div>\n                              </>\n                            ) : (\n                              <div>{String(source)}</div>\n                            )}\n                          </div>\n                        ))}\n                      </div>\n                    </details>\n                  )}\n                </div>\n              </div>\n            ))\n          )}\n          {loading && (\n            <div className=\"flex justify-start\">\n              <div className=\"bg-white text-gray-900 shadow-md rounded-xl px-5 py-3 border border-gray-200\">\n                <div className=\"flex space-x-2\">\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-bounce\"></div>\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-bounce\" style={{ animationDelay: '0.2s' }}></div>\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-bounce\" style={{ animationDelay: '0.4s' }}></div>\n                </div>\n              </div>\n            </div>\n          )}\n          <div ref={messagesEndRef} />\n        </div>\n\n        {/* Input */}\n        <form onSubmit={handleSubmit} className=\"flex space-x-4 bg-white p-4 rounded-xl shadow-md border border-gray-200\">\n          <input\n            type=\"text\"\n            value={input}\n            onChange={(e) => setInput(e.target.value)}\n            placeholder=\"Ask a question about your documents...\"\n            className=\"flex-1 border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all\"\n            disabled={loading}\n          />\n          <button\n            type=\"submit\"\n            disabled={loading || !input.trim()}\n            className=\"inline-flex items-center px-6 py-3 border border-transparent text-base font-semibold rounded-lg shadow-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200\"\n          >\n            <PaperAirplaneIcon className=\"h-5 w-5 mr-2\" />\n            Send\n          </button>\n        </form>\n      </div>\n    </Layout>\n  );\n}\n\n","import * as React from \"react\";\nfunction PaperAirplaneIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(PaperAirplaneIcon);\nexport default ForwardRef;"],"names":["module","exports","require","vendored","AppRouterContext","ReactServerDOMTurbopackClient","HooksClientContext","ServerInsertedHtml"],"mappings":"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","ignoreList":[0,1,2,3,5]}